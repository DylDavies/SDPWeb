<button mat-icon-button [matMenuTriggerFor]="menu">
    <mat-icon [matBadge]="unreadCount" matBadgeColor="warn" [matBadgeHidden]="unreadCount === 0" [class]="`icon-${theme}`" aria-hidden="false">notifications</mat-icon>
</button>
<mat-menu #menu="matMenu" class="notification-menu-panel">
    <div class="notification-header">
        <h3>Notifications</h3>
    </div>
    <div class="notification-list">
        @if (notifications.length > 0) {
            @for (notification of notifications.slice(0, 5); track notification._id) {
                <div class="notification-item"
                        [class.unread]="!notification.read"
                        (click)="!notification.read && markAsRead(notification, $event)"
                        (keydown.enter)="!notification.read && markAsRead(notification)"
                        tabindex="0">
                    <div class="notification-title">{{ notification.title }}</div>
                    <div class="notification-message">{{ notification.message }}</div>
                    <div class="notification-time">{{ notification.createdAt | date:'short' }}</div>

                    @if (!notification.read) {
                        <button mat-icon-button class="mark-read-btn" (click)="markAsRead(notification, $event)" matTooltip="Mark as read">
                            <mat-icon>done</mat-icon>
                        </button>
                    } @else {
                        <button mat-icon-button class="delete-btn" (click)="deleteNotification(notification, $event)" matTooltip="Delete notification">
                            <mat-icon>delete</mat-icon>
                        </button>
                    }
                </div>
            }
        } @else {
            <div class="no-notifications-message">
                You have no new notifications.
            </div>
        }
    </div>
    <div class="notification-footer">
        <button mat-button (click)="viewAllNotifications()">View All Notifications</button>
    </div>
</mat-menu>